(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[632],{3228:()=>{},5632:(a,e,l)=>{Promise.resolve().then(l.bind(l,6986))},6986:(a,e,l)=>{"use strict";l.d(e,{default:()=>u});var t=l(5155),s=l(2115),n=l(7665);l(9193),l(3228);var r=l(8390),c=l(2887),i=l(6451),d=l(9779);let o=s.memo(()=>{let[a,e]=(0,s.useState)(),{relic:i,standDetails:o,Rscore:u,Rrank:f,mode:h}=a||{},p=(0,s.useRef)(null),[w,v]=(0,s.useState)(!0),[j,g]=(0,s.useState)({oldData:null,newData:null}),[b,D]=(0,s.useState)(void 0),[N,k]=(0,s.useState)(0),[y,S]=(0,s.useState)(0),F=[{rank:"S+",stand:85,color:"rgb(239, 68, 68)",tag:"S+"},{rank:"S",stand:70,color:"rgb(239, 68, 68)",tag:"S"},{rank:"A",stand:50,color:"rgb(234, 179, 8)",tag:"A"},{rank:"B",stand:35,color:"rgb(234, 88 , 12)",tag:"B"},{rank:"C",stand:15,color:"rgb(163, 230, 53)",tag:"C"},{rank:"D",stand:0,color:"rgb(22,163,74)",tag:"D"}];function E(){let a=[];F.forEach(e=>{a.push({label:e.rank,value:0,color:e.color,tag:e.rank})}),D(a)}function A(){switch(h){case"Importer":let a,e,t,s,r,c;a=!0,e=new Worker(l.tu(new URL(l.p+l.u(301),l.b))),t=n.A.find(a=>a.fieldName===i.main_affix.type),s=[],null===j.oldData?i.sub_affix.forEach((a,e)=>{let l=n.A.find(e=>e.fieldName===a.type),t=l.percent?Number((100*a.value).toFixed(1)):Number(a.value.toFixed(1)),r={index:e,subaffix:l.name,data:t,count:a.count-1};s.push(r)}):s=j.oldData.returnData,o.forEach(e=>{""===e.value&&(a=!1)}),r=s.includes(a=>"速度"===a.subaffix)?.5*o.find(a=>"速度"===a.name).value:0,s.forEach(a=>{"spd"!==a.subaffix&&0!==a.count&&(r+=.2)}),c={MainData:t.name,SubData:s,partsIndex:i.type,standard:o,deviation:0},a&&(e.postMessage(c),e.onmessage=function(a){g({oldData:{relicscore:null===j.oldData?u:j.oldData.relicscore,relicrank:null===j.oldData?f:j.oldData.relicrank,returnData:s},newData:a.data}),k(a=>a+=1),null!==j.oldData&&parseInt(a.data.relicscore)>parseInt(j.oldData.relicscore)&&S(a=>a+=1)});break;case"Simulator":let d,x,m,p,w;d=!0,x=new Worker(l.tu(new URL(l.p+l.u(63),l.b))),m=n.A.find(a=>a.name===i.main_affix),p=[],null===j.oldData?i.subaffix.forEach((a,e)=>{let l={index:e,subaffix:n.A.find(e=>e.name===a.subaffix).name,data:a.data,count:a.count};p.push(l)}):p=j.oldData.returnData,o.forEach(a=>{""===a.value&&(d=!1)}),w={MainData:m.name,SubData:p,partsIndex:i.type,standard:o,deviation:.5},d&&(x.postMessage(w),x.onmessage=function(a){g({oldData:{relicscore:null===j.oldData?u:j.oldData.relicscore,relicrank:null===j.oldData?f:j.oldData.relicrank,returnData:p},newData:a.data}),k(a=>a+=1),null!==j.oldData&&parseInt(a.data.relicscore)>parseInt(j.oldData.relicscore)&&S(a=>a+=1)})}}(0,s.useEffect)(()=>{null!==localStorage.getItem("EnchantData")&&void 0!==localStorage.getItem("EnchantData")&&e(JSON.parse(localStorage.getItem("EnchantData")))},[]),(0,s.useEffect)(()=>{requestAnimationFrame(()=>{window.scrollTo({top:0,behavior:"smooth"})}),E(),A()},[a]),(0,s.useEffect)(()=>{null===p.current&&(p.current=j.oldData),function(){if(null!==j.newData){if(void 0===b){let a=[],e={label:j.newData.relicrank.rank,value:1,color:F.find(a=>a.tag===j.newData.relicrank.rank).color,tag:j.newData.relicrank.rank};a.push(e),D(a);return}if(null==b.find(a=>a.label===j.newData.relicrank.rank)){let a={label:j.newData.relicrank.rank,value:1,color:F.find(a=>a.tag===j.newData.relicrank.rank).color,tag:j.newData.relicrank.rank};D(e=>[...e,a])}else D(a=>a.map(a=>a.tag===j.newData.relicrank.rank?{...a,value:a.value+1}:a))}}()},[j]);let I=void 0!==j.newData&&void 0!==j.oldData?(0,t.jsxs)("div",{className:"flex flex-row flex-wrap  max-[600px]:!flex-col",children:[(0,t.jsx)(x,{standDetails:o,data:j.oldData,title:"重洗前"}),(0,t.jsxs)("div",{className:"flex my-auto w-[30px] moveAnimate moveAnimate2 max-[600px]:w-1/2 max-[600px]:justify-center h-[30px] ".concat(null===j.newData?"hidden":""),children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"max-[600px]:hidden",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#FFFFFF",children:(0,t.jsx)("path",{d:"m560-240-56-58 142-142H160v-80h486L504-662l56-58 240 240-240 240Z"})}),(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"min-[600px]:hidden",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#e8eaed",children:(0,t.jsx)("path",{d:"M440-800v487L216-537l-56 57 320 320 320-320-56-57-224 224v-487h-80Z"})})]}),(0,t.jsx)(x,{standDetails:o,data:j.newData,title:"重洗後"})]}):(0,t.jsx)(t.Fragment,{});return(0,t.jsx)(d.A.Provider,{value:{relic:i,Rrank:f,Rscore:u,standDetails:o,isChangeAble:w,standDetails:o},children:(0,t.jsx)("div",{className:"flex flex-col w-4/5 mx-auto max-[600px]:w-[90%]",children:(0,t.jsxs)("div",{className:"w-[100%] border-gray-600 my-4 justify-center flex flex-row flex-wrap max-[900px]:flex-col",children:[(0,t.jsxs)("div",{className:"flex flex-row flex-wrap w-1/2 max-[900px]:w-[100%]",children:[(0,t.jsx)("div",{className:"flex flex-row w-1/2 max-[900px]:w-1/2 max-[400px]:w-[100%]",children:"Importer"===h?(0,t.jsx)(c.G,{}):(0,t.jsx)(c.d,{})}),(0,t.jsx)("div",{className:"w-1/2 max-[900px]:w-1/2 max-[400px]:w-[100%]",children:(0,t.jsx)(r.V,{})})]}),(0,t.jsxs)("div",{className:"w-1/2 max-[900px]:w-[100%]",children:[(0,t.jsxs)("div",{className:"flex flex-row",children:[(0,t.jsx)("span",{className:"text-red-600 text-lg font-bold",children:"模擬強化"}),(0,t.jsx)("button",{className:"processBtn ml-2",onClick:()=>A(),children:"再洗一次"}),(0,t.jsx)("button",{className:"processBtn ml-2",onClick:()=>void(null!==j.newData&&(g({oldData:j.newData,newData:null}),S(0))),children:"套用新強化"}),(0,t.jsx)("button",{className:"processBtn ml-2",onClick:()=>void(k(0),S(0),g({oldData:p.current,newData:null}),E()),children:"還原至初始"})]}),(0,t.jsx)("div",{className:"my-2",children:(0,t.jsxs)("span",{children:["目前重洗次數:",(0,t.jsx)("span",{className:"text-white ml-1",children:N})]})}),(0,t.jsx)("div",{children:I}),(0,t.jsx)("div",{children:(0,t.jsx)(m,{PieNums:b,successCount:y})})]})]})})})}),x=s.memo(a=>{let{standDetails:e,data:l,title:s}=a,r=[];return null!==l?(l.returnData.map((a,l)=>{let s,c="";var i=n.A.find(e=>e.name===a.subaffix);let d=void 0!==e.find(e=>e.name===a.subaffix);i.percent&&!a.data.toString().includes("%")&&(s=a.data+"%");var o="https://raw.githubusercontent.com/Mar-7th/StarRailRes/master/icon/property/".concat(i.icon,".png");switch(a.count){case 0:c="rgb(122, 122, 122)";break;case 1:c="rgb(67, 143, 67)";break;case 2:c="rgb(23, 93, 232)";break;case 3:c="rgb(67, 17, 184)";break;case 4:c="rgb(219, 171, 15)";break;case 5:c="#FF55FF"}r.push((0,t.jsxs)("div",{className:"flex flex-row",children:[(0,t.jsx)("div",{className:"flex justify-center items-center",children:(0,t.jsx)("span",{className:"mr-0.5 text-white w-[20px] h-[20px] rounded-[20px]   flex justify-center items-center",style:{backgroundColor:c},children:a.count})}),(0,t.jsxs)("div",{className:"w-[120px] flex flex-row",children:[(0,t.jsx)("div",{className:"flex justify-center items-center",children:(0,t.jsx)("img",{src:o,alt:"555",width:24,height:24})}),(0,t.jsx)("span",{className:"".concat(d?"text-yellow-500 font-bold":"text-white"," text-left flex"),children:a.subaffix})]}),(0,t.jsxs)("span",{className:"flex w-[70px]",children:[":",(0,t.jsx)("span",{className:"ml-2 text-white ",children:s})]})]},"Subaffix_"+a.subaffix))}),(0,t.jsxs)("div",{className:"flex flex-col mx-1",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-amber-700 font-bold text-lg",children:s}),(0,t.jsxs)("div",{className:"flex flex-row",children:[(0,t.jsx)("span",{children:"遺器評級:"}),(0,t.jsxs)("span",{className:"pl-2",style:{color:l.relicrank.color},children:[l.relicrank.rank," ",l.relicscore,"/100"]})]})]}),(0,t.jsx)("div",{children:r})]})):(0,t.jsx)(t.Fragment,{})}),m=s.memo(a=>{let{PieNums:e,successCount:l}=a;return void 0!==e?(0,t.jsxs)("div",{className:"w-[100%] flex flex-row flex-wrap",children:[(0,t.jsx)("div",{className:"min-w-[300px]",children:(0,t.jsx)(i.r,{series:[{innerRadius:20,arcLabelMinAngle:35,arcLabel:a=>"".concat(a.value,"次"),data:e}],height:200,margin:{top:10,right:0,bottom:0,left:-100},slotProps:{legend:{hidden:!0}}})}),(0,t.jsxs)("div",{className:"flex flex-col w-2/5 max-[500px]:w-[100%] mt-2 ".concat(void 0===e.find(a=>0!==a.value)?"hidden":""),children:[(0,t.jsx)("div",{children:(0,t.jsx)("span",{className:"text-amber-700 font-bold text-lg",children:"模擬次數"})}),(0,t.jsx)("div",{className:"text-center",children:e.map((a,e)=>{if(0!==a.value)return(0,t.jsxs)("div",{className:"my-1 flex flex-row [&>*]:max-[500px]:w-[100px] [&>*]:max-[500px]:text-center",children:[(0,t.jsx)("div",{style:{color:a.color},className:"w-[30px] text-left ",children:"".concat(a.tag)}),(0,t.jsx)("div",{style:{color:a.color},className:"w-[70px] text-right",children:"".concat(a.value,"次")})]},"pieNums"+e)})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex justify-start max-[500px]:justify-center",children:(0,t.jsx)("span",{className:"text-amber-700 font-bold text-lg",children:"翻盤次數"})}),(0,t.jsx)("div",{className:"flex justify-start max-[500px]:justify-center",children:(0,t.jsxs)("span",{className:"text-white",children:[l,"次"]})})]})]})]}):(0,t.jsx)(t.Fragment,{})}),u=o}},a=>{var e=e=>a(a.s=e);a.O(0,[8,141,212,994,282,441,684,358],()=>e(5632)),_N_E=a.O()}]);